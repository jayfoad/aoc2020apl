⎕IO←0
p←↑⊃⎕NGET'p11.txt'1
f←{⍵-⍨{+/,⍵}⌺3 3⊢⍵}
g←{n←f'#'=⍵ ⋄ '#'@(⍸(n=0)∧'L'=⍵)⊢'L'@(⍸(4≤n)∧'#'=⍵)⊢⍵}
+/,'#'=g⍣≡p ⍝ part 1
a←(⍴p)⍴⊂0/⊂0 0 ⋄ ∘.{⍺≡⍵: ⋄ 'LL'≢p[⊂¨⍺⍵]: ⋄ (≠/t)∧~0∊t←|⍺-⍵: ⋄ 'L'∊p[(⊂⍺)+(⊂×⍵-⍺)×1↓⍳⌈/t]: ⋄ a[⊂⍺],←⊂⊂⍵}⍨⍳⍴p
g←{n←⍵∘{+/'#'=⍺[⍵]}¨a ⋄ '#'@(⍸(n=0)∧'L'=⍵)⊢'L'@(⍸(5≤n)∧'#'=⍵)⊢⍵}
+/,'#'=g⍣≡p ⍝ part 2
