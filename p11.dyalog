⎕IO←0
p←'L'=↑⊃⎕NGET'p11.txt'1
f←{p∧(1+4×⍵)>{+/,⍵}⌺3 3⊢⍵}
+/,f⍣≡0×p ⍝ part 1
a←⊂¨⊃{(⊂⍋⍺)⌷⍵}/↓⍉⊃{⍺,⊂⍵}⌸/{⍵,¨⌽⍵}↓⍉↑⊃,/2,/¨⊃,/({(+/¨⍵)(-/¨⍵)(⊣/¨⍵)(⊢/¨⍵)}⍸p){⊂⍵}⌸¨⊂⍳+/,p
g←{(1+4×⍵)>+/¨a⌷¨⊂⍵}
+/g⍣≡0/⍨+/,p ⍝ part 2
