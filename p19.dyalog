⎕IO←0
p q←1↓¨{⍵⊂⍨0=≢¨⍵}(⊂''),⊃⎕NGET'p19.txt'1
p←'[0-9ab|]+'⎕S'&'¨p
a←{a⊣{n←⍎⊃⍵ ⋄ 'ab'∊⍨⊃⊃⌽⍵:(n⊃a)←⊃⌽⍵ ⋄ (n⊃a)←'(?:',(⊃,/{'|'=⊃⍵:⍵ ⋄ a⊃⍨⍎⍵}¨1↓⍵),')'}¨p}⍣≡a←''↑⍨≢p
a0←⊃a ⋄ a31←31⊃a ⋄ a42←42⊃a
+/≢¨('^',a0,'$')⎕S''¨q ⍝ part 1
+/≢¨('^',a42,'+(',a42,'(|(?1))',a31,')$')⎕S''¨q ⍝ part 2
