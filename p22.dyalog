⎕IO←0
p←⍎¨¨2↓¨{⍵⊂⍨0=≢¨⍵}(⊂''),⊃⎕NGET'p22.txt'1
s←{⍵+.×⌽1+⍳≢⍵} ⍝ score
f←{,∘(⍵⌽⊃¨⍺)¨@⍵⊢1↓¨⍺}
s∊{0∊≢¨⍵:⍵ ⋄ ∇⍵ f </⊃¨⍵} p ⍝ part 1
g←{0∊≢¨⍵:⍵ ⋄ ⍺←0⍴⍨0,1+≢∊⍵ ⋄ (≢⍺)>⍺⍳n←∊⍵,≢⊃⍵:0⍬ ⋄ (⍺⍪n)∇⍵ f {∧/(≢¨⍵)>z←⊃¨⍵:sg z↑¨1↓¨⍵ ⋄ </z}⍵} ⍝ game
sg←{>/⌈/¨⍵:0 ⋄ </≢¨g ⍵} ⍝ subgame
s∊g p ⍝ part 2
