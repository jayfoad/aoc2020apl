p←⍎¨¨2↓¨{⍵⊂⍨0=≢¨⍵}(⊂''),⊃⎕NGET'p22.txt'1
s←{⍵+.×⌽⍳≢⍵} ⍝ score
f←{(1↓¨⍵),¨(⍺/⊃¨⍵)((~⍺)/⌽⊃¨⍵)}
s∊{0∊≢¨⍵:⍵ ⋄ ∇(>/⊃¨⍵)f ⍵} p ⍝ part 1
g←{0∊≢¨⍵:⍵ ⋄ (⊂⍵)∊⍺:0⍬ ⋄ (⍺,⊂⍵)∇⍵ f⍨{∧/(≢¨⍵)>z←⊃¨⍵:>/≢¨⍬ g z↑¨1↓¨⍵ ⋄ >/z}⍵}
s∊⍬ g p ⍝ part 2
